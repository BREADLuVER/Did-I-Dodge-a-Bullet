"use strict";exports.id=56,exports.ids=[56],exports.modules={56:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(2295),r=a(3729),n=a(3889);let i=(e,t=300)=>{let a=(0,r.useRef)(null);return(0,r.useCallback)(async(...s)=>(a.current&&clearTimeout(a.current),new Promise((r,n)=>{a.current=setTimeout(async()=>{try{let t=await e(...s);r(t)}catch(e){n(e)}},t)})),[e,t])},o=({onCompanySelect:e,onSkip:t,className:a=""})=>{let[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)([]),[m,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(-1),[y,f]=(0,r.useState)(""),x=(0,r.useRef)(null),w=(0,r.useRef)(null),C=i((0,r.useCallback)(async e=>{if(e.length<2){d([]),u(!1);return}u(!0),f("");try{console.log("\uD83D\uDD0D Searching for:",e);let t=await n.lj.searchCompanies(e,6),a=new Map;t.forEach(e=>{let t=(0,n.SY)(e.name);a.has(t)||a.set(t,e)});let s=Array.from(a.values());console.log("\uD83D\uDCCB Search results:",s),d(s)}catch(e){console.error("Search error:",e),f("Failed to search companies. Please try again.")}finally{u(!1)}},[]),200),v=t=>{l(t.name),d([]),h(!1),b(-1),e(t)},j=async()=>{o.trim()&&e(await n.lj.findOrCreateCompany(o.trim()))};return(0,r.useEffect)(()=>{let e=e=>{w.current&&!w.current.contains(e.target)&&x.current&&!x.current.contains(e.target)&&(h(!1),b(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>()=>{},[]),s.jsx("div",{className:`relative ${a}`,children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Enter Company Name"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Get company-specific insights and compare your experience with others"}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select from suggestions or type your own company name"})]}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("input",{ref:x,type:"text",value:o,onChange:e=>{let t=e.target.value;l(t),b(-1),h(!0),t.length<2?(d([]),u(!1)):C(t)},onKeyDown:e=>{if(p)switch(e.key){case"ArrowDown":e.preventDefault(),b(e=>e<c.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),b(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),g>=0&&c[g]?v(c[g]):o.trim()&&j();break;case"Escape":h(!1),b(-1),x.current?.blur()}},onFocus:()=>h(!0),placeholder:"Start typing company name...",className:"w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",autoComplete:"off",autoFocus:!0}),m&&s.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})]}),p&&(c.length>0||m)&&s.jsx("div",{ref:w,className:"relative z-50 w-full bg-white border border-gray-200 rounded-lg shadow-lg overflow-y-auto",style:{maxHeight:"200px"},children:m&&0===c.length?(0,s.jsxs)("div",{className:"px-4 py-3 text-gray-500 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mx-auto mb-2"}),"Searching..."]}):c.map((e,t)=>(0,s.jsxs)("button",{onClick:()=>v(e),className:`w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors ${t===g?"bg-blue-50 border-l-4 border-blue-500":""}`,children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm text-gray-500",children:e.industry&&s.jsx("span",{children:e.industry})}),e.submissionCount>0&&(0,s.jsxs)("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[e.submissionCount," submission",1!==e.submissionCount?"s":""]})]})]},e.id))}),y&&s.jsx("div",{className:"text-red-500 text-sm text-center",children:y}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsx("button",{onClick:j,disabled:!o.trim(),className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Use This Name"}),s.jsx("button",{onClick:t,className:"flex-1 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Skip for Anonymous"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-sm text-blue-800",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Why enter a company name?"}),(0,s.jsxs)("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Compare your experience with others at the same company"}),s.jsx("li",{children:"• See common red flags patterns for this company"}),s.jsx("li",{children:"• Help future candidates make informed decisions"}),s.jsx("li",{children:"• Contribute to workplace transparency"})]})]})]})})}},3889:(e,t,a)=>{a.d(t,{lj:()=>g,SY:()=>m});var s=a(7097),r=a(6041);let n={apiKey:"AIzaSyCTMqWzORaG1eK0Tp-T8e0h39rDJpLMPPQ",authDomain:"did-i-dodge-a-bullet.firebaseapp.com",projectId:"did-i-dodge-a-bullet",storageBucket:"did-i-dodge-a-bullet.firebasestorage.app",messagingSenderId:"190454478964",appId:"1:190454478964:web:8b54426780fe1792627921"},i=null,o=null,l=()=>{if(!i){let e=(0,r.C6)();i=e.length>0?e[0]:(0,r.ZF)(n)}return o||(o=(0,s.ad)(i)),{app:i,db:o}},c=()=>{if(!o){let{db:e}=l();return e}return o};c(),(()=>{if(!i){let{app:e}=l()}})();let d={companies:[],lastUpdated:0,isLoaded:!1},m=e=>e?e.trim().toLowerCase().replace(/\s+/g," ").replace(/[^\w\s-]/g,"").replace(/\b(inc|corp|corporation|llc|ltd|limited|co|company|group|holdings|enterprises|ventures|partners|associates)\b/g,"").replace(/\b(the|a|an)\b/g,"").replace(/\s+/g," ").trim():"",u=(e,t)=>{let a=[];if(!e)return a;a.push(e.trim()),a.push(e.toLowerCase().trim());let s=e.toLowerCase().replace(/\b(inc|corp|corporation|llc|ltd|limited|co|company|group|holdings|enterprises|ventures|partners|associates)\b/g,"").replace(/\s+/g," ").trim();if(s&&s!==e.toLowerCase().trim()&&a.push(s),t)try{let s=new URL(t).hostname;s&&s!==e.toLowerCase()&&(a.push(s),s.startsWith("www.")&&a.push(s.substring(4)))}catch{}return Array.from(new Set(a.filter(e=>e.trim())))},p=(e,t)=>{if(!e||!t)return 0;let a=[],s=e.length,r=t.length;for(let e=0;e<=r;e++)a[e]=[e];for(let e=0;e<=s;e++)a[0][e]=e;for(let n=1;n<=r;n++)for(let r=1;r<=s;r++)t.charAt(n-1)===e.charAt(r-1)?a[n][r]=a[n-1][r-1]:a[n][r]=Math.min(a[n-1][r-1]+1,a[n][r-1]+1,a[n-1][r]+1);let n=Math.max(s,r);return 0===n?1:(n-a[r][s])/n};class h{constructor(){this.db=c()}static getInstance(){return h.instance||(h.instance=new h),h.instance}async loadAllCompanies(){let e=Date.now();if(d.isLoaded&&e-d.lastUpdated<3e5)return d.companies;try{if(!this.db)return console.warn("Firebase not initialized"),[];let t=(0,s.hJ)(this.db,"companies"),a=(await (0,s.PL)(t)).docs.map(e=>{let t=e.data();return{id:e.id,name:t.name||"",normalizedName:t.normalizedName||"",aliases:t.aliases||[],website:t.website,location:t.location,industry:t.industry,company_size:t.company_size,company_type:t.company_type,founded_year:t.founded_year,specialities:t.specialities,locations:t.locations,submissionCount:t.submissionCount||0,lastSubmission:t.lastSubmission?.toDate(),commonFlags:t.commonFlags||[],averageFlagCount:t.averageFlagCount||0,severityTrends:t.severityTrends||{light:0,medium:0},createdAt:t.createdAt?.toDate(),updatedAt:t.updatedAt?.toDate()}});return d={companies:a,lastUpdated:e,isLoaded:!0},console.log(`Loaded ${a.length} companies`),a}catch(e){return console.error("Error loading companies:",e),[]}}async searchCompanies(e,t=10){if(!e.trim())return[];let a=await this.loadAllCompanies(),s=m(e),r=[];for(let t of a){let a=0,n="fuzzy";if(t.normalizedName===s)a=1,n="exact";else if(t.name.toLowerCase().includes(e.toLowerCase()))a=.9,n="partial";else{for(let e of t.aliases)if(m(e)===s){a=.8,n="alias";break}if(0===a){let e=p(s,t.normalizedName);e>.7&&(a=e,n="fuzzy")}}a>0&&r.push({company:t,relevanceScore:a,matchType:n})}return r.sort((e,t)=>t.relevanceScore-e.relevanceScore).slice(0,t).map(e=>e.company)}async findOrCreateCompany(e){if(!e.trim())throw Error("Company name cannot be empty");let t=await this.searchCompanies(e,1);if(t.length>0){let a=t[0];if(p(m(e),a.normalizedName)>.8)return a}return this.createCompany(e)}async createCompany(e){if(!this.db)throw Error("Firebase not initialized");let t=m(e),a=u(e),r={name:e.trim(),normalizedName:t,aliases:a,submissionCount:0,commonFlags:[],averageFlagCount:0,severityTrends:{light:0,medium:0},createdAt:(0,s.Bt)(),updatedAt:(0,s.Bt)()};try{let e={id:(await (0,s.ET)((0,s.hJ)(this.db,"companies"),r)).id,...r,createdAt:new Date,updatedAt:new Date};return d.companies.push(e),e}catch(e){throw console.error("Error creating company:",e),e}}async updateCompanyWithSubmission(e,t){if(!this.db){console.warn("Firebase not initialized. Skipping company update.");return}try{let a=(0,s.JU)(this.db,"companies",e),r=d.companies.find(t=>t.id===e);if(!r){console.warn("Company not found in cache for update");return}let n={submissionCount:r.submissionCount+1,commonFlags:Array.from(new Set([...r.commonFlags,...t.markedFlags])),averageFlagCount:(r.averageFlagCount*r.submissionCount+t.markedFlags.length)/(r.submissionCount+1),severityTrends:{light:r.severityTrends.light+t.severityBreakdown.light,medium:r.severityTrends.medium+t.severityBreakdown.medium},lastSubmission:(0,s.Bt)(),updatedAt:(0,s.Bt)()};await (0,s.r7)(a,n);let i=d.companies.findIndex(t=>t.id===e);-1!==i&&(d.companies[i]={...r,...n,lastSubmission:new Date,updatedAt:new Date})}catch(e){console.error("Error updating company with submission:",e)}}async refreshCompanies(){d={companies:[],lastUpdated:0,isLoaded:!1},await this.loadAllCompanies()}async getAllCompanies(){return this.loadAllCompanies()}}let g=h.getInstance()}};