"use strict";exports.id=479,exports.ids=[479],exports.modules={1479:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(2295),r=s(3729),i=s(3889),n=s(9514),l=s(5961),o=s(9224);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,o.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var c=s(3024);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,o.Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),u=(0,o.Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),p=(0,o.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var h=s(1354);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,o.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var g=s(3148);let y=({companyName:e,onBack:t})=>{let[s,o]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0);(0,r.useEffect)(()=>{b(!0),i.lj.refreshCompanies().then(()=>i.lj.searchCompanies(e,1)).then(e=>{o(e[0]||null),b(!1)})},[e]);let f=(0,r.useMemo)(()=>s?.commonFlags&&0!==s.commonFlags.length?Object.entries(s.commonFlags.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{})).map(([e,t])=>{let s=n.Y.find(t=>t.id===e);return s?{...s,count:t}:null}).filter(e=>!!e).sort((e,t)=>(t?.count||0)-(e?.count||0)).slice(0,3):[],[s]),v=e=>{switch(e){case"medium":return"border-orange-500 bg-orange-50";case"light":return"border-yellow-500 bg-yellow-50";default:return"border-gray-500 bg-gray-50"}},w=e=>{switch(e){case"medium":return a.jsx(l.Z,{className:"w-4 h-4 text-orange-600"});case"light":return a.jsx(d,{className:"w-4 h-4 text-yellow-600"});default:return a.jsx(l.Z,{className:"w-4 h-4 text-gray-600"})}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("button",{onClick:t,className:"mb-6 flex items-center text-blue-600 hover:underline",children:[a.jsx(c.Z,{className:"w-5 h-5 mr-2"})," Back to Results"]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-6 text-gray-900 flex items-center",children:[a.jsx(m,{className:"w-7 h-7 text-orange-500 mr-3"}),e]}),y?a.jsx("div",{className:"text-gray-500 mt-4",children:"Loading insights..."}):s?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[a.jsx(u,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.submissionCount||0}),a.jsx("div",{className:"text-sm text-blue-700",children:"Checkups Submitted"})]}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[a.jsx(p,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.averageFlagCount?.toFixed(1)||"0.0"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Avg Flags per Checkup"})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[a.jsx(h.Z,{className:"w-8 h-8 text-red-500 mx-auto mb-2"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.severityTrends?.medium||0}),a.jsx("div",{className:"text-sm text-red-700",children:"Medium Severity Flags"})]})]}),f.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[a.jsx(x,{className:"w-5 h-5 text-green-500 mr-2"}),"Most Common Red Flags"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.map((e,t)=>(0,a.jsxs)("div",{className:`border-2 rounded-lg p-4 ${v(e?.severity||"light")}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("span",{className:"text-xs font-semibold text-gray-600 bg-white px-2 py-1 rounded",children:["#",t+1," â€¢ ",e?.count," time",e?.count!==1?"s":""]}),w(e?.severity||"light")]}),a.jsx("p",{className:"text-gray-800 font-medium text-sm mb-2",children:e?.text}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[a.jsx("span",{className:"capitalize",children:e?.category}),a.jsx("span",{className:"capitalize",children:e?.severity})]})]},e?.id))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Severity Breakdown"}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Light: ",s.severityTrends?.light||0]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Medium: ",s.severityTrends?.medium||0]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[a.jsx(g.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Last updated: ",(e=>{if(!e)return"N/A";try{let t;if(t=e.seconds?new Date(1e3*e.seconds):e.toDate?e.toDate():new Date(e),isNaN(t.getTime()))return"N/A";return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(e){return console.error("Error formatting date:",e),"N/A"}})(s.lastSubmission)]})]})]}):a.jsx("div",{className:"text-gray-500 mt-4",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx(m,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No insights available yet"}),(0,a.jsxs)("p",{className:"text-gray-500",children:["Be the first to submit a checkup for ",e,"!"]})]})})]})]})}},3889:(e,t,s)=>{s.d(t,{lj:()=>x,SY:()=>m});var a=s(7097),r=s(6041);let i={apiKey:"AIzaSyCTMqWzORaG1eK0Tp-T8e0h39rDJpLMPPQ",authDomain:"did-i-dodge-a-bullet.firebaseapp.com",projectId:"did-i-dodge-a-bullet",storageBucket:"did-i-dodge-a-bullet.firebasestorage.app",messagingSenderId:"190454478964",appId:"1:190454478964:web:8b54426780fe1792627921"},n=null,l=null,o=()=>{if(!n){let e=(0,r.C6)();n=e.length>0?e[0]:(0,r.ZF)(i)}return l||(l=(0,a.ad)(n)),{app:n,db:l}},d=()=>{if(!l){let{db:e}=o();return e}return l};d(),(()=>{if(!n){let{app:e}=o()}})();let c={companies:[],lastUpdated:0,isLoaded:!1},m=e=>e?e.trim().toLowerCase().replace(/\s+/g," ").replace(/[^\w\s-]/g,"").replace(/\b(inc|corp|corporation|llc|ltd|limited|co|company|group|holdings|enterprises|ventures|partners|associates)\b/g,"").replace(/\b(the|a|an)\b/g,"").replace(/\s+/g," ").trim():"",u=(e,t)=>{let s=[];if(!e)return s;s.push(e.trim()),s.push(e.toLowerCase().trim());let a=e.toLowerCase().replace(/\b(inc|corp|corporation|llc|ltd|limited|co|company|group|holdings|enterprises|ventures|partners|associates)\b/g,"").replace(/\s+/g," ").trim();if(a&&a!==e.toLowerCase().trim()&&s.push(a),t)try{let a=new URL(t).hostname;a&&a!==e.toLowerCase()&&(s.push(a),a.startsWith("www.")&&s.push(a.substring(4)))}catch{}return Array.from(new Set(s.filter(e=>e.trim())))},p=(e,t)=>{if(!e||!t)return 0;let s=[],a=e.length,r=t.length;for(let e=0;e<=r;e++)s[e]=[e];for(let e=0;e<=a;e++)s[0][e]=e;for(let i=1;i<=r;i++)for(let r=1;r<=a;r++)t.charAt(i-1)===e.charAt(r-1)?s[i][r]=s[i-1][r-1]:s[i][r]=Math.min(s[i-1][r-1]+1,s[i][r-1]+1,s[i-1][r]+1);let i=Math.max(a,r);return 0===i?1:(i-s[r][a])/i};class h{constructor(){this.db=d()}static getInstance(){return h.instance||(h.instance=new h),h.instance}async loadAllCompanies(){let e=Date.now();if(c.isLoaded&&e-c.lastUpdated<3e5)return c.companies;try{if(!this.db)return console.warn("Firebase not initialized"),[];let t=(0,a.hJ)(this.db,"companies"),s=(await (0,a.PL)(t)).docs.map(e=>{let t=e.data();return{id:e.id,name:t.name||"",normalizedName:t.normalizedName||"",aliases:t.aliases||[],website:t.website,location:t.location,industry:t.industry,company_size:t.company_size,company_type:t.company_type,founded_year:t.founded_year,specialities:t.specialities,locations:t.locations,submissionCount:t.submissionCount||0,lastSubmission:t.lastSubmission?.toDate(),commonFlags:t.commonFlags||[],averageFlagCount:t.averageFlagCount||0,severityTrends:t.severityTrends||{light:0,medium:0},createdAt:t.createdAt?.toDate(),updatedAt:t.updatedAt?.toDate()}});return c={companies:s,lastUpdated:e,isLoaded:!0},console.log(`Loaded ${s.length} companies`),s}catch(e){return console.error("Error loading companies:",e),[]}}async searchCompanies(e,t=10){if(!e.trim())return[];let s=await this.loadAllCompanies(),a=m(e),r=[];for(let t of s){let s=0,i="fuzzy";if(t.normalizedName===a)s=1,i="exact";else if(t.name.toLowerCase().includes(e.toLowerCase()))s=.9,i="partial";else{for(let e of t.aliases)if(m(e)===a){s=.8,i="alias";break}if(0===s){let e=p(a,t.normalizedName);e>.7&&(s=e,i="fuzzy")}}s>0&&r.push({company:t,relevanceScore:s,matchType:i})}return r.sort((e,t)=>t.relevanceScore-e.relevanceScore).slice(0,t).map(e=>e.company)}async findOrCreateCompany(e){if(!e.trim())throw Error("Company name cannot be empty");let t=await this.searchCompanies(e,1);if(t.length>0){let s=t[0];if(p(m(e),s.normalizedName)>.8)return s}return this.createCompany(e)}async createCompany(e){if(!this.db)throw Error("Firebase not initialized");let t=m(e),s=u(e),r={name:e.trim(),normalizedName:t,aliases:s,submissionCount:0,commonFlags:[],averageFlagCount:0,severityTrends:{light:0,medium:0},createdAt:(0,a.Bt)(),updatedAt:(0,a.Bt)()};try{let e={id:(await (0,a.ET)((0,a.hJ)(this.db,"companies"),r)).id,...r,createdAt:new Date,updatedAt:new Date};return c.companies.push(e),e}catch(e){throw console.error("Error creating company:",e),e}}async updateCompanyWithSubmission(e,t){if(!this.db){console.warn("Firebase not initialized. Skipping company update.");return}try{let s=(0,a.JU)(this.db,"companies",e),r=c.companies.find(t=>t.id===e);if(!r){console.warn("Company not found in cache for update");return}let i={submissionCount:r.submissionCount+1,commonFlags:Array.from(new Set([...r.commonFlags,...t.markedFlags])),averageFlagCount:(r.averageFlagCount*r.submissionCount+t.markedFlags.length)/(r.submissionCount+1),severityTrends:{light:r.severityTrends.light+t.severityBreakdown.light,medium:r.severityTrends.medium+t.severityBreakdown.medium},lastSubmission:(0,a.Bt)(),updatedAt:(0,a.Bt)()};await (0,a.r7)(s,i);let n=c.companies.findIndex(t=>t.id===e);-1!==n&&(c.companies[n]={...r,...i,lastSubmission:new Date,updatedAt:new Date})}catch(e){console.error("Error updating company with submission:",e)}}async refreshCompanies(){c={companies:[],lastUpdated:0,isLoaded:!1},await this.loadAllCompanies()}async getAllCompanies(){return this.loadAllCompanies()}}let x=h.getInstance()}};